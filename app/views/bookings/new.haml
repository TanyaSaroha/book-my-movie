!!!
%html
  %head
    %meta{:content => "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %title AdminPanel
    = csrf_meta_tags
    = csp_meta_tag
    = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
    = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'

    %link{:href => "https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i", :rel => "stylesheet"}/
    %body#page-top
      #wrapper
      #content-wrapper.d-flex.flex-column
        #content
          .container-fluid
            .card.shadow.mb-4.mt-4
              .card-header.py-3
                .row
                  .col-lg-10
                    %h3.text.m-0.font-weight-bold.text-info Select Seats
                  .col-lg-2
                    = link_to shows_path, {class: 'btn btn-warning btn-circle'} do
                      %i.fa.fa-close{title: "Cancel"}

              .card-body
                .row
                  .col-1.mb-3
                  .col-5.mb-3
                    .btn.btn-warning.btn-block SCREEN
                .row
                  .col-8
                    .row
                      - @seats.each do |seat|
                        .col-1.mb-1.ml-2
                          .card.seat{class: "#{seat.type}", id: "#{seat.id}"}
                            .card-body
                              .row.no-gutters.align-items-center
                                .col.mr-2
                                  .text.mb-0.font-weight-bold.text-secondary=seat.code
                  .col-4
                    .row
                      %h1.h4.text-gray-900.mb-4 Booking Details:
                    .row
                      .col-4
                        .text.font-weight-bold.text-warning.mb-1 Movie:
                      .col-6
                        .text.font-weight-bold.text-info.mb-1= @show.movie.name
                    .row.mt-2
                      .col-4
                        .text.font-weight-bold.text-warning.mb-1 Time:
                      .col-6
                        .text.font-weight-bold.text-info.mb-1= Show::TIMINGS.as_json[@show.time_slot]

                    .row.mt-2
                      .col-4
                        .text.font-weight-bold.text-warning.mb-1 Seats:
                      .col-6
                        .text.font-weight-bold.text-info.mb-1#seatCount

                    .row.mt-2
                      .col-4
                        .text.font-weight-bold.text-warning.mb-1 Cost:
                      .col-6
                        .text.font-weight-bold.text-info.mb-1#totalCost

                    .row.mt-5
                      .col-1.mb-3
                      .col-8.mb-3
                        .btn.btn-success.btn-block.disabled#confirmButton Confirm Booking


                    .row.mt-5
                      .col-1#totalCost
                        .green-box
                      .col-6
                        .text.font-weight-bold.text-info.mb-1 Selected
                    .row.mt-2
                      .col-1
                        .grey-box
                      .col-6
                        .text.font-weight-bold.text-info.mb-1 Available
                    .row.mt-2
                      .col-1
                        .red-box
                      .col-6
                        .text.font-weight-bold.text-info.mb-1 Sold

:javascript
  selectSeatIDs = []
  $(".seat").on('click', function(event){
    if (this.classList.contains("selected")) {
      this.classList.remove("selected");
      index = selectSeatIDs.indexOf(this.id);
      selectSeatIDs.splice(index, 1)
      $("#seatCount")[0].innerText = Number($("#seatCount")[0].innerText) - 1;
      reduceCost(this);
    } else {
      this.classList.add("selected");
      selectSeatIDs.push(this.id);
      $("#seatCount")[0].innerText = Number($("#seatCount")[0].innerText) + 1;
      addCost(this);
    }
    checkAndActivateConfirmButton();
  });

  function addCost(seat) {
    costElement = $("#totalCost")[0]
    classList = seat.classList
    if (classList.contains("silver")){
      costElement.innerText = Number(costElement.innerText) + 150;
    } else if (classList.contains("gold")){
      costElement.innerText = Number(costElement.innerText) + 200;
    } else if (classList.contains("platinum")){
      costElement.innerText = Number(costElement.innerText) + 300;
    }
  }

  function reduceCost(seat) {
    costElement = $("#totalCost")[0]
    classList = seat.classList
    if (classList.contains("silver")){
      costElement.innerText = Number(costElement.innerText) - 150;
    } else if (classList.contains("gold")){
      costElement.innerText = Number(costElement.innerText) - 200;
    } else if (classList.contains("platinum")){
      costElement.innerText = Number(costElement.innerText) - 300;
    }
  }

  function checkAndActivateConfirmButton() {
    confirmButton = $("#confirmButton")[0];
    if($(".selected").length == 0) {
      confirmButton.classList.add("disabled");
    } else {
      confirmButton.classList.remove("disabled");
    }
  }
